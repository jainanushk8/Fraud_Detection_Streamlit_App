
Collecting usage statistics. To deactivate, set browser.gatherUsageStats to false.


  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://172.28.0.12:8501
  External URL: http://34.87.70.78:8501

[LightGBM] [Fatal] The number of features in data (15) is not the same as it was in training data (14).
You can set ``predict_disable_shape_check=true`` to discard this error, but please be aware what you are doing.
[31m──[0m[31m────────────────────────[0m[31m [0m[1;31mTraceback [0m[1;2;31m(most recent call last)[0m[31m [0m[31m─────────────────────────[0m[31m──[0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mexec_code.py[0m: [31m [0m
[31m [0m [94m128[0m in [92mexec_func_with_error_handling[0m                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/streamlit/runtime/scriptrunner/[0m[1;33mscript_runner[0m [31m [0m
[31m [0m [1;33m.py[0m:[94m669[0m in [92mcode_to_exec[0m                                                              [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/content/[0m[1;33mstreamlit_app.py[0m:[94m106[0m in [92m<module>[0m                                            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m103 [0m[2m│   │   [0mtransaction_type                                                       [31m [0m
[31m [0m   [2m104 [0m[2m│   [0m)                                                                          [31m [0m
[31m [0m   [2m105 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m [31m❱ [0m106 [2m│   [0mprediction_proba = [1;4mmodel.predict_proba(input_df)[0m[:, [94m1[0m] [2m# Probability of be[0m [31m [0m
[31m [0m   [2m107 [0m[2m│   [0mprediction = (prediction_proba > [94m0.5[0m).astype([96mint[0m) [2m# Default threshold 0.5[0m  [31m [0m
[31m [0m   [2m108 [0m[2m│   [0m                                                                           [31m [0m
[31m [0m   [2m109 [0m[2m│   [0mst.subheader([33m"[0m[33mPrediction Result:[0m[33m"[0m)                                         [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/lightgbm/[0m[1;33msklearn.py[0m:[94m1627[0m in [92mpredict_proba[0m    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1624 [0m[2m│   │   [0m**kwargs: Any,                                                        [31m [0m
[31m [0m   [2m1625 [0m[2m│   [0m):                                                                        [31m [0m
[31m [0m   [2m1626 [0m[2;90m│   │   [0m[33m"""Docstring is set after definition, using a template."""[0m            [31m [0m
[31m [0m [31m❱ [0m1627 [2m│   │   [0mresult = [96msuper[0m().predict(                                             [31m [0m
[31m [0m   [2m1628 [0m[2m│   │   │   [0mX=X,                                                              [31m [0m
[31m [0m   [2m1629 [0m[2m│   │   │   [0mraw_score=raw_score,                                              [31m [0m
[31m [0m   [2m1630 [0m[2m│   │   │   [0mstart_iteration=start_iteration,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/lightgbm/[0m[1;33msklearn.py[0m:[94m1144[0m in [92mpredict[0m          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1141 [0m[2m│   │   [0mpredict_params = _choose_param_value([33m"[0m[33mnum_threads[0m[33m"[0m, predict_params, [96ms[0m [31m [0m
[31m [0m   [2m1142 [0m[2m│   │   [0mpredict_params[[33m"[0m[33mnum_threads[0m[33m"[0m] = [96mself[0m._process_n_jobs(predict_params[[33m"[0m [31m [0m
[31m [0m   [2m1143 [0m[2m│   │   [0m                                                                      [31m [0m
[31m [0m [31m❱ [0m1144 [2m│   │   [0m[94mreturn[0m [96mself[0m._Booster.predict(  [2m# type: ignore[union-attr][0m             [31m [0m
[31m [0m   [2m1145 [0m[2m│   │   │   [0mX,                                                                [31m [0m
[31m [0m   [2m1146 [0m[2m│   │   │   [0mraw_score=raw_score,                                              [31m [0m
[31m [0m   [2m1147 [0m[2m│   │   │   [0mstart_iteration=start_iteration,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/lightgbm/[0m[1;33mbasic.py[0m:[94m4767[0m in [92mpredict[0m            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m4764 [0m[2m│   │   │   │   [0mnum_iteration = [96mself[0m.best_iteration                           [31m [0m
[31m [0m   [2m4765 [0m[2m│   │   │   [0m[94melse[0m:                                                             [31m [0m
[31m [0m   [2m4766 [0m[2m│   │   │   │   [0mnum_iteration = -[94m1[0m                                            [31m [0m
[31m [0m [31m❱ [0m4767 [2m│   │   [0m[94mreturn[0m predictor.predict(                                             [31m [0m
[31m [0m   [2m4768 [0m[2m│   │   │   [0mdata=data,                                                        [31m [0m
[31m [0m   [2m4769 [0m[2m│   │   │   [0mstart_iteration=start_iteration,                                  [31m [0m
[31m [0m   [2m4770 [0m[2m│   │   │   [0mnum_iteration=num_iteration,                                      [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/lightgbm/[0m[1;33mbasic.py[0m:[94m1204[0m in [92mpredict[0m            [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1201 [0m[2m│   │   │   │   [0mpredict_type=predict_type,                                    [31m [0m
[31m [0m   [2m1202 [0m[2m│   │   │   [0m)                                                                 [31m [0m
[31m [0m   [2m1203 [0m[2m│   │   [0m[94melif[0m [96misinstance[0m(data, np.ndarray):                                    [31m [0m
[31m [0m [31m❱ [0m1204 [2m│   │   │   [0mpreds, nrow = [96mself[0m.__pred_for_np2d(                               [31m [0m
[31m [0m   [2m1205 [0m[2m│   │   │   │   [0mmat=data,                                                     [31m [0m
[31m [0m   [2m1206 [0m[2m│   │   │   │   [0mstart_iteration=start_iteration,                              [31m [0m
[31m [0m   [2m1207 [0m[2m│   │   │   │   [0mnum_iteration=num_iteration,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/lightgbm/[0m[1;33mbasic.py[0m:[94m1361[0m in [92m__pred_for_np2d[0m    [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1358 [0m[2m│   │   │   │   [0m)                                                             [31m [0m
[31m [0m   [2m1359 [0m[2m│   │   │   [0m[94mreturn[0m preds, nrow                                                [31m [0m
[31m [0m   [2m1360 [0m[2m│   │   [0m[94melse[0m:                                                                 [31m [0m
[31m [0m [31m❱ [0m1361 [2m│   │   │   [0m[94mreturn[0m [96mself[0m.__inner_predict_np2d(                                 [31m [0m
[31m [0m   [2m1362 [0m[2m│   │   │   │   [0mmat=mat,                                                      [31m [0m
[31m [0m   [2m1363 [0m[2m│   │   │   │   [0mstart_iteration=start_iteration,                              [31m [0m
[31m [0m   [2m1364 [0m[2m│   │   │   │   [0mnum_iteration=num_iteration,                                  [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/lightgbm/[0m[1;33mbasic.py[0m:[94m1307[0m in                    [31m [0m
[31m [0m [92m__inner_predict_np2d[0m                                                                 [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m1304 [0m[2m│   │   [0m[94melif[0m [96mlen[0m(preds.shape) != [94m1[0m [95mor[0m [96mlen[0m(preds) != n_preds:                  [31m [0m
[31m [0m   [2m1305 [0m[2m│   │   │   [0m[94mraise[0m [96mValueError[0m([33m"[0m[33mWrong length of pre-allocated predict array[0m[33m"[0m)   [31m [0m
[31m [0m   [2m1306 [0m[2m│   │   [0mout_num_preds = ctypes.c_int64([94m0[0m)                                     [31m [0m
[31m [0m [31m❱ [0m1307 [2m│   │   [0m_safe_call(                                                           [31m [0m
[31m [0m   [2m1308 [0m[2m│   │   │   [0m_LIB.LGBM_BoosterPredictForMat(                                   [31m [0m
[31m [0m   [2m1309 [0m[2m│   │   │   │   [0m[96mself[0m._handle,                                                 [31m [0m
[31m [0m   [2m1310 [0m[2m│   │   │   │   [0mptr_data,                                                     [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m [2;33m/usr/local/lib/python3.11/dist-packages/lightgbm/[0m[1;33mbasic.py[0m:[94m313[0m in [92m_safe_call[0m          [31m [0m
[31m [0m                                                                                      [31m [0m
[31m [0m   [2m 310 [0m[2;33m│   │   [0m[33mThe return value from C API calls.[0m                                    [31m [0m
[31m [0m   [2m 311 [0m[2;33m│   [0m[33m"""[0m                                                                       [31m [0m
[31m [0m   [2m 312 [0m[2m│   [0m[94mif[0m ret != [94m0[0m:                                                              [31m [0m
[31m [0m [31m❱ [0m 313 [2m│   │   [0m[1;4;94mraise[0m[1;4m LightGBMError(_LIB.LGBM_GetLastError().decode([0m[1;4;33m"[0m[1;4;33mutf-8[0m[1;4;33m"[0m[1;4m))[0m         [31m [0m
[31m [0m   [2m 314 [0m                                                                              [31m [0m
[31m [0m   [2m 315 [0m                                                                              [31m [0m
[31m [0m   [2m 316 [0m[94mdef[0m[90m [0m[92m_is_numeric[0m(obj: Any) -> [96mbool[0m:                                            [31m [0m
[31m────────────────────────────────────────────────────────────────────────────────────────[0m
[1;91mLightGBMError: [0mThe number of features in data [1m([0m[1;36m15[0m[1m)[0m is not the same as it was in training
data [1m([0m[1;36m14[0m[1m)[0m.
You can set ``[33mpredict_disable_shape_check[0m=[35mtrue[0m`` to discard this error, but please be 
aware what you are doing.
